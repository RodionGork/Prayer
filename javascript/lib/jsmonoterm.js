function JsMonoTerm(f){var a=f.w;var e=f.h;var b=this;var d="";for(var c=0;c<a;c++){d+=" "}this.emptyLine=d;var j=$(f.selector);j.addClass("jsterm");var g=$("<div/>");g.addClass("jsterm-cursor");j.append(g);this.cx=0;this.cy=0;this.w=a;this.h=e;this.div=j;for(var c=0;c<e;c++){this.addLine()}$(document).keypress(function(h){b.key(h)}).keydown(function(h){if(h.keyCode==8){h.charCode=8;b.key(h)}});setInterval(function(){b.cursor()},300);this.getc=null;this.gets=null}JsMonoTerm.prototype.move=function(a,b){this.cx=a;this.cy=b};JsMonoTerm.prototype.print=function(c){var a=c.length;var b=this.div.find("span").get(this.cy);var d=$(b).text();d=d.substr(0,this.cx)+c+d.substr(this.cx+a);$(b).text(d);this.cx+=a};JsMonoTerm.prototype.addLine=function(){this.div.append($("<span>"+this.emptyLine+"</span><br/>"))};JsMonoTerm.prototype.delLine=function(b){if(!b){b=0}var a=$(this.div.find("span").get(b));a.next().remove();a.remove();this.addLine()};JsMonoTerm.prototype.clear=function(){for(var a=this.h-1;a>=0;a--){this.delLine(a)}this.move(0,0)};JsMonoTerm.prototype.println=function(a){this.print(a);this.cx=0;this.cy+=1;while(this.cy>=this.h){this.delLine();this.cy-=1}};JsMonoTerm.prototype.key=function(b){b=b.charCode;if(b>=32){this.print(String.fromCharCode(b))}else{if(b==13){this.println("")}else{if(b==8&&this.cx>0){this.cx--;this.print(" ");this.cx--}}}this.cursorPos();if(b>=32&&this.getc){var a=this.getc;this.getc=null;a(String.fromCharCode(b))}};JsMonoTerm.prototype.cursor=function(){var a=this.div.find(".jsterm-cursor");if(a.is(":visible")){a.hide();return}else{a.show()}this.cursorPos()};JsMonoTerm.prototype.cursorPos=function(){var e=this.div.find(".jsterm-cursor");var d=$(this.div.find("span").get(this.cy));var a=d.offset();e.width(d.width()/this.w);e.height(d.height()/4);var b={};b.left=a.left+d.width()*this.cx/this.w;b.top=a.top+d.height()*3/4;e.offset(b)};
